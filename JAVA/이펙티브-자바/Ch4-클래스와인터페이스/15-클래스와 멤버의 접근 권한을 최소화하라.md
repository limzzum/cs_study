## 클래스와 멤버의 접근 권한을 최소화하라

접근 권한을 막아 내부 구현을 숨긴다는 것은 캡슐화를 만드는 것과 같다.
구현과 API를 분리하는 것이다.
=> 클라이언트는 내부 구현에 얽매이지 않고 편하게 사용할 수 있고 나중에 내부 구현을 바꾸게 되어도
   유연하게 변경이 가능하다.

접근 제한자에는 4가지가 있다.

```
private : 멤버를 선언한 톱레벨 클래스에서만 접근할 수 있다.
package-private : 멤버가 소속된 패키지 안의 모든 클래스에서 접근할 수 있다.
protected : package-private의 접근 범위를 포함하며, 이 멤버를 선언한 클래스이 하위 
            클래스에서도 접근할 수 있다.
public : 모든 곳에서 접근할 수 있다.
```

톱레벨 클래스와 인터페이스는 package-private과 public 둘 중 하나로 지정할 수 있는데
public으로 지정하면 공개 API가 되기 때문에 외부에서 사용하지 않는다면 package-private으로 지정하자.
그럼 내부구현이 되어 언제든 수정할 수 있다.
Serializable을 구현한 클래스는 접근 제한을 해도 직렬화 역직렬화 과정에서 필드가 공개 API가 될 수 있으니 주의하자.

이렇게 접근 제한을 지정할 때에는 가능한 최소한으로 지정해 주어야 한다.
public클래스의 package-private에서 protected로 변경하는 것은 공개API로 바뀌는 것이기 때문에
그 멤버에 접근할 수 있는 대상 범위가 엄청나게 넓어진다.

그런데 이러한 경우엔 접근 제한자를 최소화하는 것이 어려워진다.
```
- 상위클래스의 메서드를 재정의 하는 경우에는 접근 수준을 더 좁게 설정할 수 없다.
   => 상위 클래스의 인스턴스는 하위 클래스의 인스턴스로 대체해 사용할 수 있어야 한다는
      리스코프 치환 원칙을 지키기 위해서이다.

클래스가 인터페이스를 구현하는 것은 이 규칙의 특별한 예이다.
클래스에서는 인터페이스가 정의한 모든 메서드를 public으로 설정해야 한다.
```

다시 접근제한자를 최소화하는 방법을 살펴보자.
```
- public 클래스의 인스턴스 필드는 되도록 public이 아니어야 한다.
   - 누구나 접근할 수 있게 되어 값을 제한하지 못하게 되고, 필드가 수정될 때 추가 부수 작업을 수행하지 못한다.
      => 락 획득 같은 작업을 수행하지 못해 스레드 안전하지 못하게 된다.
   - 필드가 final이면서 불변이더라도 내부구현을 수정하기 어려워진다.
   - final이지만 가변 객체를 참조한다면 참조 대상은 그대로여도 대상이 수정될 수 있다.
```

그럼 배열필드같은 가변 객체를 공개하려면 두 가지 방법을 사용할 수 있다.

```
- 배열 필드를 private으로 만들고, public 불변 리스트를 추가한다.

private static final Ting[] PRIVATE_VALUES = {..};
public static final List<Thing> VALUES = 
      Collections.unmodifiableList(Arrays.asList(PRIVATE_VALUES));

- 배열 필드를 private으로 만들고, 반환하는 public 메서드를 추가한다.

private static final Thing[] PRIVATE_VALUES = {..};
public static final Thing[] values() {
   return PRIVATE_VALUES.clone(); // 방어적 복사
}

```

이런 접근 제한자 말고도 자바 9에서는 모듈 시스템 개념이 도입되었다.
모듈은 패키지들의 모음인데 모듈에 속하는 패키지 중 공개할 것들을 설정할 수 있다.
접근 제한자에 상관없이 공개되지 않은 패키지라면 모듈 외부에서는 접근할 수 없다.
이것을 가장 잘 활용하고 주로 사용하는 곳은 JDK 자체이다.

결론적으로 접근제한자를 설정할 때에는 최소한의 범위를 지정해주도록하자.
의도치 않게 공개 API가 된다면 클라이언트가 이에 의존하게 되어 내부 구현을 수정하기 어려워진다.
public 클래스에서는 상수용 public static final 필드 외에는 어떠한 public 필드도 가지지 않도록 하고,
public static final 필드가 참조하는 객체가 불변인지 확인하자.