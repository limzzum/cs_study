# 1.2 왜 아직도 자바는 변화하는가?

새로운 언어의 등장으로 진화하지 않은 기존 언어는 도태된다.  
완벽한 언어란 없으며 모든 언어엔 장단점이 있다.  
C, C++을 예로 들자면
  - 장: 작은 런타임 풋프린트덕에 운영체제와 다양한 임베디드 시스템에서 사용
  - 단: 안전성 부족

다음과 같은 특성이 있고, 실제로 런타임 풋프린트에 여유가 있는 애플리케이션이라면 안전성이 높은 C#, Java가 선호된다.  

이런 프로그래밍 생태계에서 자바는 커다란 생태계를 성공적으로 구축했다. 어떻게?

---
## 1.2.1 프로그래밍 언어 생태계에서 자바의 위치
자바는 
- 많은 유용한 라이브러리를 포함하는 잘 설계된 객체지향 언어
- 스레드와 락을 이용한 소소한 동시성 지원 
- 코드를 JVM 바이트코드로 컴파일 하는 특징(가상 머신 코드 지원)

로서 인터넷 애플릿 프로그램의 주요 언어가 되었다.  

하지만 빅데이터의 등장으로 멀티코어 컴퓨터나 컴퓨팅 클러스터를 이용해 빅데이터 처리의 필요성이 대두되고, 병렬 프로세싱을 활용해야하는 상황 속에서 현재의 자바로는 충분히 대응할 수 없었다.  

따라서 이런 환경 변화(멀티코어 프로세서, 새로운 프로그래머 유입)로 자바스크립트, 스칼라 등의 언어가 등장하고 대중화되기 시작했다.  

자바 8은 더 다양한 프로그래밍 도구가 존재하며, 다양한 문제를 더 빠르고 정확하며 쉽게 유지보수하도록 한다.  

이어서 **자바 8 설계의 밑바탕을 이루는 세 가지 프로그램이 개념**이 소개된다.

---
## 1.2.2 스트림 처리

_**스트림: 한 번에 한 개씩 만들어지는 연속적인 데이터 항목들의 모임**_

Java 에서의 스트림
- 입력 스트림: `System.in`
- 출력 스트림: `System.out`


이론적으로 프로그램은 입력 스트림에서 데이터를 한 개씩 읽어들이고, 출력 스트림에서는 한 개씩 기록한다.  
즉, 어떤 프로그램의 출력 스트림이 다른 프로그램의 입력 스트림이 될 수 있다.  

```
cat file1 file2 | tr "[A-Z]" "[a-z]" | sort | tail -3
```

이는 파일의 단어를 소문자로 바꾼 후, 정렬했을 때 가장 마지막에 오는 세 단어를 출력하는 프로그램이다.  

이처럼 `sort`는 앞서 대문자를 소문자로 바꾼 후 나온 스트림을 입력 스트림으로 받아, 정렬 후 출력 스트림으로 전달한다.  

자바 8에는 `java.util.stream` 패키지에 스트림 API가 추가되었다.  
스트림 패키지에 정의된 `Stream<T>`는 T형식으로 구성된 일련의 항목을 의미한다. (이때, 우선 스트림 API가 조립 라인처럼 어떤 항목을 연속으로 제공하는 어떤 기능이라고 단순하게 생각하면 좋다.)  

스트림 API의 핵심은
- 우리가 하려는 작업을 데이터베이스 질의처럼 고수준으로 추상화해서 일련의 스트림으로 만들어 처리할 수 있다
- 스트림 파이프라인을 이용해 입력 부분을 여러 CPU 코어에 쉽게 할당할 수 있다 (여기서 스레드라는 복잡한 작업을 사용하지 않으면서도 공짜로 병렬성을 얻을 수 있다)

---
## 1.2.3 동작 파라미터화로 메서드에 코드 전달하기

_**코드 일부를 API로 전달하는 기능이 추가**_

sort에 파라미터를 제공해서 역순 정렬 등 다양한 정렬을 수행할 수 있지만, 일단 sort로 할 수 있는 동작은 정해져있다.  
예시로 **2013US0001**, **2014UK0002** .. 등의 [연도 국가코드 고객ID] 형식을 가지는 송장이 있고 고객 ID나 국가 코드순으로 정렬할 때, 자바 8 이전에는 Comparator 객체를 만들어 sort에 넘겨줄 수도 있었다.

```java
public int compareUsingCustomerId(String inv1, String inv2) {
    // 어떤 기준으로 정렬할 지 정의 
    ...
}
```

하지만 이제는 sort에 우리가 임의로 메서드를 정의해 넘겨주며 위처럼 정렬을 부탁할 수도 있다.  
이런 기능을 이론적으로 `동작 파라미터화(behavior parameterization)`라고 한다.

---
## 1.2.4 병렬성과 공유 가변 데이터

스트림의 메서드로 전달되는 코드의 동작 방식을 조금 바꿔주면, 우리는 병렬성을 공짜로 얻을 수 있다.  
스트림 메서드로 전달하는 코드는 다른 코드와 동시에 실행하더라도 안전하게 실행될 수 있어야 하고, 그럴려면 **공유된 가변 데이터**에 접근하지 않아야한다.  
이런 함수는 순수 함수, 부작용 없는 함수, 상태 없는 함수 ... 라고도 하며 나중에 다시 나온다.  

다시 돌아와 공유된 데이터를 동시에 접근하려면 기존처럼 `synchronized`를 이용해서 공유된 가변 데이터를 보호하는 규칙을 만들 수 있지만, 자바 8은 스트림을 이용해 병렬성을 이용할 수 있다.  
** `synchronized`가 기피되는 이유는 일반적으로 시스템 성능에 악영향을 미치기 때문이라고 ..

공유되지 않는 가변 데이터, 메서드, 함수 코드를 다른 메서드로 전달하는 두가지 기능은 함수형 프로그래밍 패러다임의 핵심적인 사항이다.  
반면 명령형 프로그래밍 패러다임에는 일련의 가변 상태로 프로그램을 정의한다. 공유되지 않은 가변 데이터 요구사항이랑 인수를 결과로 변환하는 기능과 관련된다. 즉, 이 요구사항은 수학적인 함수처럼 함수가 정해진 기능만 수행하며 (겉으로 보이는) 다른 부작용은 일으키지 않음을 의미한다.  

---
## 1.2.5 자바가 진화해야 하는 이유

이제까지 자바는 
- 제네릭
  - `List` -> `List<String>`
  - 익숙하진 않았지만 컴파일할 때 더 많은 에러를 검출할 수 있고, 리스트의 유형을 알 수 있어 가독성이 좋아졌다.
- for-each 루프

와 같은 변화로 자바 8에서는 기존의 값을 변화시키는 데 집중했던 고전적인 객체지향에서 벗어나 함수형 프로그래밍으로 다가섰다.  

함수형 프로그래밍에서는 우리가 하려는 작업(주어진 비용 이하로 A에서 B로 이동할 수 있는 모든 경로를 대표하는 값 생성)이 최우서신시되며, 그 작업을 어떻게 수행하는지(자료구조를 탐색하면서 컴포넌트를 수정)는 별개의 문제로 취급한다.  
극단적으로 생각하면 객체지향과 함수형 프로그래밍은 상극이다.  
하지만 자바 8에서 함수형 프로그래밍을 도입함으로써 두 가지 프로그래밍 패러다임의 장점을 모두 활용할 수 있게 된다. 즉, 어떤 문제를 더 효율적으로 해결할 수 있는 다양한 도구를 얻게 되었다.  

---
_**해당 1.2 절의 내용을 요약하자만, 언어는 하드웨어나 프로그래머 기대의 변화에 부응하는 방향으로 변화해야한다는 것**_